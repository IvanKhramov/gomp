syntax="proto3";

package protos;
option go_package = "internal/protos";

enum Direction {
    left = 0;
    right = 1;
    up = 2;
    down = 3;
}

message Position {
    double x = 1;
    double y = 2;
}

message Velocity {
    double speed = 1;
    Direction direction = 2;
}

message Unit {
    uint32 id = 1;
    Position position = 2;
    int32 frame = 3;
    string skin = 4;
    string action = 5;
    Velocity velocity = 6;
    Direction side = 7;
}

message PatchUnit {
    uint32 id = 1;
    optional Position position = 2;
    optional string action = 5;
    optional Velocity velocity = 6;
    optional Direction side = 7;
}

message Event {
    EventType type = 1;
    oneof data {
        EventInit init = 2;
        EventConnect connect = 3;
        EventExit exit = 4;
        EventIdle idle = 5;
        EventMove move = 6;
        GameState state = 7;
        GameStatePatche state_patch = 8;
    }
}

enum EventType {
   init = 0;
   connect = 1;
   exit = 2;
   idle = 3;
   move = 4;
   empty = 5;
   state = 6;
   state_patch = 7;
}

message EventInit {
    uint32 player_id = 1;
}

message EventConnect {
    Unit unit = 1;
}

message EventExit {
    uint32 player_id = 1;
}

message EventIdle {
    uint32 player_id = 1;
}

message EventMove {
    uint32 player_id = 1;
    Direction direction = 2;
}

message GameState {
    map<uint32, Unit> units = 1;
}
  
message GameStatePatche {
    map<uint32, PatchUnit> units = 1;
}